# PowerEdge v2.0 - Sistema Avan√ßado de Monitoramento de Energia

Sistema de monitoramento em tempo real para m√∫ltiplas fontes de energia usando Raspberry Pi com interface UX moderna e avan√ßada.

## üöÄ Novidades da Vers√£o 2.0

### Interface Moderna
- **Design System Avan√ßado**: Interface completamente redesenhada com design moderno
- **Sidebar Responsiva**: Navega√ß√£o intuitiva com sidebar colaps√°vel
- **Dashboard Interativo**: Overview completo com cards de status em tempo real
- **Tema Claro**: Design profissional com sistema de cores consistente
- **Responsivo**: Adapta√ß√£o autom√°tica para dispositivos m√≥veis

### Funcionalidades Avan√ßadas
- **4 Fontes de Energia**: Rede, Solar, Gerador e **UPS/Bateria** (NOVO!)
- **Notifica√ß√µes em Tempo Real**: Sistema de alertas visuais
- **Exporta√ß√£o de Dados**: Exportar hist√≥rico em formato CSV
- **Estat√≠sticas Avan√ßadas**: Gr√°ficos de disponibilidade (planejado)
- **Configura√ß√µes Din√¢micas**: Ajuste de par√¢metros em tempo real

### Melhorias T√©cnicas
- **WebSocket Otimizado**: Reconex√£o autom√°tica e controle de estado
- **Arquitetura Modular**: C√≥digo JavaScript orientado a objetos
- **Performance**: Carregamento otimizado e cache inteligente
- **Acessibilidade**: Interface amig√°vel e navega√ß√£o por teclado

## üìä Caracter√≠sticas

### Monitoramento
- **4 Fontes de Energia**:
  - üè† Rede El√©trica (Prioridade 1)
  - ‚òÄÔ∏è Energia Solar (Prioridade 2)  
  - ‚ö° Gerador (Prioridade 3)
  - üîã UPS/Bateria (Prioridade 4)

### Interfaces
- **WebSocket**: Dados em tempo real (ws://ip:8765)
- **API REST**: Consulta de eventos e status
- **Interface Web**: Dashboard moderno e responsivo

### Dados
- **Banco SQLite**: Hist√≥rico de eventos persistente
- **Logs Estruturados**: Sistema de logging avan√ßado
- **Exporta√ß√£o**: CSV com filtros customiz√°veis

## üîß Hardware Necess√°rio

- Raspberry Pi 4B (recomendado) ou 3B+
- ADS1115 ADC (16-bit, I2C)
- Sensores de tens√£o para cada fonte
- Divisores de tens√£o (se necess√°rio)
- Cabos jumper e protoboard

### Conex√µes I2C
```
ADS1115 -> Raspberry Pi
VDD     -> 3.3V (Pin 1)
GND     -> GND (Pin 6)
SCL     -> GPIO 3 (Pin 5)
SDA     -> GPIO 2 (Pin 3)
ADDR    -> GND (endere√ßo 0x48)
```

### Canais do ADS1115
- **A0**: Rede El√©trica
- **A1**: Energia Solar
- **A2**: Gerador
- **A3**: UPS/Bateria

## üõ†Ô∏è Instala√ß√£o

### 1. Prepara√ß√£o do Sistema
```bash
# Clone o reposit√≥rio
git clone <repo-url>
cd PowerEdge

# Torne os scripts execut√°veis
chmod +x setup_python.sh install.sh

# Configure o ambiente Python
./setup_python.sh

# Reinicie ap√≥s configurar I2C
sudo reboot
```

### 2. Instala√ß√£o Principal
```bash
# Execute a instala√ß√£o completa
./install.sh
```

### 3. Configura√ß√£o Manual (Alternativa)
```bash
# Instale depend√™ncias
pip install -r requirements.txt

# Configure I2C
sudo raspi-config
# Interface Options > I2C > Enable

# Execute o sistema
python app/run.py
```

## üåê API Endpoints

### Status e Monitoramento
- `GET /status` - Status atual de todas as fontes
- `GET /eventos` - Lista eventos com filtros
  - `?limite=100` - Limitar n√∫mero de eventos
  - `?fonte=rede` - Filtrar por fonte espec√≠fica
- `POST /eventos` - Criar evento manual

### WebSocket
- **URL**: `ws://ip:8765`
- **Dados**: JSON com status de todas as fontes em tempo real
- **Frequ√™ncia**: Configur√°vel (padr√£o: 1 segundo)

### Exemplo de Resposta da API
```json
{
  "status": "ok",
  "hardware_disponivel": true,
  "timestamp": "2025-07-02T10:30:00",
  "fontes": {
    "rede": {
      "tensao": 220.5,
      "estado": "ATIVA",
      "config": {
        "canal": 0,
        "nome": "Rede El√©trica",
        "cor": "#4ecdc4",
        "icone": "üè†",
        "prioridade": 1
      }
    }
  }
}
```

## ‚öôÔ∏è Configura√ß√£o

### Vari√°veis de Ambiente (.env)
```bash
DATABASE_PATH=energia.db
LOG_LEVEL=INFO
LOG_FILE=logs/energia.log
LIMIAR_TENSAO=0.8
INTERVALO_LEITURA=1.0
FLASK_HOST=0.0.0.0
FLASK_PORT=5000
WEBSOCKET_HOST=0.0.0.0
WEBSOCKET_PORT=8765
```

### Configura√ß√µes do Hardware
Edite `app/config.py` para ajustar:
- Gain do ADS1115
- Taxa de amostragem
- Mapeamento de canais
- Limiares por fonte

## üöÄ Uso

### Inicializa√ß√£o Manual
```bash
# Execute diretamente
python app/run.py

# Ou use o script
./run.sh
```

### Servi√ßo Systemd (Recomendado)
```bash
# Habilite inicializa√ß√£o autom√°tica
sudo systemctl enable poweredge
sudo systemctl start poweredge

# Verifique status
sudo systemctl status poweredge

# Monitore logs
sudo journalctl -u poweredge -f
```

### Acessos
- **Interface Web**: http://ip-raspberry:5000
- **WebSocket**: ws://ip-raspberry:8765
- **Logs**: `tail -f logs/energia.log`

## üì± Interface Web

### Dashboard
- Overview geral do sistema
- Cards de status por fonte
- Eventos recentes
- M√©tricas de disponibilidade

### Fontes de Energia
- Monitoramento detalhado
- Status visual com cores
- M√©tricas em tempo real
- √çcones identificadores

### Hist√≥rico de Eventos
- Lista filtrada de eventos
- Busca por fonte e tipo
- Exporta√ß√£o para CSV
- Pagina√ß√£o autom√°tica

### Estat√≠sticas
- Gr√°ficos de disponibilidade
- Timeline de eventos
- Relat√≥rios de uptime
- An√°lise de tend√™ncias

### Configura√ß√µes
- Ajuste de limiares
- Configura√ß√£o de notifica√ß√µes
- Informa√ß√µes do sistema
- Par√¢metros de monitoramento

## üîß Estrutura do Projeto

```
PowerEdge/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ run.py              # Aplica√ß√£o principal
‚îÇ   ‚îî‚îÄ‚îÄ config.py           # Configura√ß√µes e constantes
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ index.html          # Interface web moderna
‚îÇ   ‚îú‚îÄ‚îÄ script.js           # JavaScript avan√ßado (ES6+)
‚îÇ   ‚îî‚îÄ‚îÄ style.css           # Design system moderno
‚îú‚îÄ‚îÄ logs/                   # Arquivos de log
‚îú‚îÄ‚îÄ backups/                # Backups do banco
‚îú‚îÄ‚îÄ requirements.txt        # Depend√™ncias Python
‚îú‚îÄ‚îÄ setup_python.sh        # Script de configura√ß√£o
‚îú‚îÄ‚îÄ install.sh             # Script de instala√ß√£o
‚îú‚îÄ‚îÄ run.sh                 # Script de execu√ß√£o
‚îî‚îÄ‚îÄ README.md              # Este arquivo
```

## üêõ Troubleshooting

### Hardware n√£o detectado
```bash
# Verifique I2C
sudo i2cdetect -y 1

# Deve mostrar device no endere√ßo 0x48
#      0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
# 40: -- -- -- -- -- -- -- -- 48 -- -- -- -- -- -- --
```

### WebSocket n√£o conecta
```bash
# Verifique se a porta est√° aberta
netstat -tulpn | grep 8765

# Teste conex√£o
telnet localhost 8765
```

### Problemas de permiss√£o
```bash
# Adicione usu√°rio ao grupo i2c
sudo usermod -a -G i2c $USER

# Reinicie e verifique
groups
```

### Logs para debug
```bash
# Log em tempo real
tail -f logs/energia.log

# Log do servi√ßo
sudo journalctl -u poweredge -f

# Verificar status do hardware
python -c "import board, busio; print('I2C OK')"
```

## üéÆ Ambiente Simulado e Demonstra√ß√£o

O PowerEdge v2.0 inclui um **sistema de simula√ß√£o integrado** que permite testar e demonstrar todas as funcionalidades sem hardware f√≠sico.

### üîÑ Detec√ß√£o Autom√°tica de Modo

O sistema detecta automaticamente se o hardware est√° dispon√≠vel:

```python
# Detec√ß√£o autom√°tica no c√≥digo
try:
    import board, busio, adafruit_ads1x15
    HARDWARE_AVAILABLE = True
    print("‚úÖ Hardware detectado - Modo PRODU√á√ÉO")
except ImportError:
    HARDWARE_AVAILABLE = False
    print("üéÆ Hardware n√£o encontrado - Modo SIMULA√á√ÉO")
```

### üìä Dados Simulados Realistas

#### Valores Base por Fonte:
- üè† **Rede El√©trica**: 220V ¬± 10% (198V - 242V)
- ‚òÄÔ∏è **Energia Solar**: 24V ¬± 10% (21.6V - 26.4V)  
- ‚ö° **Gerador**: 12.5V ¬± 10% (11.25V - 13.75V)
- üîã **UPS/Bateria**: 12V ¬± 10% (10.8V - 13.2V)

#### Estados Din√¢micos:
- **ATIVA**: Tens√£o > limiar configurado
- **FALHA**: Tens√£o < limiar configurado  
- **ERRO**: Simulado raramente para testes

### üöÄ Como Executar Simula√ß√£o

#### 1. Modo Simula√ß√£o Autom√°tico
```bash
# Execute em qualquer sistema (Windows/Linux/Mac)
python app/run.py
# Sa√≠da: "AVISO: Hardware n√£o dispon√≠vel. Executando em modo simula√ß√£o."
```

#### 2. Script de Demonstra√ß√£o Completa
```bash
# Demonstra√ß√£o interativa com todos os recursos
python demo.py

# Op√ß√µes espec√≠ficas
python demo.py --api-only     # Apenas testa API REST
python demo.py --ws-only      # Apenas testa WebSocket
python demo.py --host 192.168.1.100  # Teste remoto
```

#### 3. Interface Web Simulada
```bash
# Inicie o servidor
python app/run.py

# Acesse no navegador
http://localhost:5000
```

### üéØ Recursos Dispon√≠veis na Simula√ß√£o

#### ‚úÖ **Funcionalidades Completas:**
- Dashboard em tempo real com dados simulados
- WebSocket com atualiza√ß√µes autom√°ticas (1s)
- API REST totalmente funcional
- Hist√≥rico de eventos simulados
- Exporta√ß√£o de dados CSV
- Sistema de notifica√ß√µes
- Todas as 4 fontes de energia
- Interface responsiva completa

#### üì± **Indicadores Visuais:**
- **Status do Sistema**: "Modo Simula√ß√£o" em vez de "Hardware"
- **Cards de Fonte**: Cores e √≠cones indicando simula√ß√£o
- **Logs**: Marca√ß√£o clara de dados simulados
- **API Response**: `"hardware_disponivel": false`

### üîß Personaliza√ß√£o da Simula√ß√£o

#### Editar Valores Base:
```python
# Em app/run.py - fun√ß√£o simular_leitura()
base_values = {
    "rede": 127.0,      # Para sistema 127V (EUA)
    "solar": 48.0,      # Para sistema solar 48V
    "gerador": 13.8,    # Para gerador 12V carregado
    "ups": 24.0         # Para UPS industrial 24V
}
```

#### Ajustar Variabilidade:
```python
# Varia√ß√£o atual: ¬±10%
return base * (0.9 + random.random() * 0.2)

# Para ¬±5% (mais est√°vel):
return base * (0.95 + random.random() * 0.1)

# Para ¬±20% (mais vari√°vel):
return base * (0.8 + random.random() * 0.4)
```

### üß™ Script de Teste Avan√ßado

O arquivo `demo.py` oferece testes automatizados:

```bash
# Teste completo do sistema
python demo.py

# Sa√≠da esperada:
üîã PowerEdge v2.0 - Demonstra√ß√£o do Sistema
üìä Testando API Endpoints...
‚úÖ GET /status - OK
‚úÖ GET /eventos - OK  
‚úÖ POST /eventos - OK
üîå Testando WebSocket por 15 segundos...
‚úÖ WebSocket conectado
üìä Dados recebidos: 3/4 fontes ativas
```

### üåç Casos de Uso da Simula√ß√£o

#### **Desenvolvimento:**
- ‚úÖ Desenvolver sem hardware caro
- ‚úÖ Testar em Windows/Mac/Linux
- ‚úÖ Debug de funcionalidades
- ‚úÖ Valida√ß√£o de UI/UX

#### **Demonstra√ß√£o:**
- ‚úÖ Apresentar para clientes/investidores
- ‚úÖ Treinamento de usu√°rios
- ‚úÖ Valida√ß√£o de conceitos
- ‚úÖ Prototipa√ß√£o r√°pida

#### **Testes:**
- ‚úÖ Integra√ß√£o cont√≠nua (CI/CD)
- ‚úÖ Teste de APIs sem hardware
- ‚úÖ Valida√ß√£o de atualiza√ß√µes
- ‚úÖ Teste de carga/performance

#### **Produ√ß√£o:**
- ‚úÖ Fallback autom√°tico se hardware falhar
- ‚úÖ Continuidade de servi√ßo
- ‚úÖ Debug remoto
- ‚úÖ Modo de manuten√ß√£o

## üìà Melhorias Futuras

### v2.1 (Planejado)
- [ ] Gr√°ficos interativos com Chart.js
- [ ] Alertas por email/SMS
- [ ] API de configura√ß√£o din√¢mica
- [ ] Backup autom√°tico do banco

### v2.2 (Planejado)
- [ ] Modo escuro
- [ ] PWA (Progressive Web App)
- [ ] Integra√ß√£o com Home Assistant
- [ ] Dashboard personalizado

### v3.0 (Vis√£o)
- [ ] Machine Learning para predi√ß√£o
- [ ] Integra√ß√£o com inversor solar
- [ ] Controle autom√°tico de cargas
- [ ] App mobile nativo

## üìö Documenta√ß√£o Completa

O PowerEdge inclui documenta√ß√£o abrangente para todos os casos de uso:

### üìñ Guias Principais
- **[INSTALLATION.md](INSTALLATION.md)** - Guia completo de instala√ß√£o e configura√ß√£o
- **[DEVELOPER.md](DEVELOPER.md)** - Documenta√ß√£o para desenvolvedores e API
- **[ARCHITECTURE.md](ARCHITECTURE.md)** - Arquitetura e separa√ß√£o de c√≥digo
- **[DEPLOYMENT.md](DEPLOYMENT.md)** - Deploy em produ√ß√£o, demonstra√ß√£o e desenvolvimento

### üîß Suporte e Troubleshooting
- **[FAQ.md](FAQ.md)** - Perguntas frequentes e solu√ß√µes de problemas
- **[API.md](API.md)** - Documenta√ß√£o completa da API REST e WebSocket

### üéØ Casos de Uso
- **Produ√ß√£o**: Raspberry Pi com hardware real ‚Üí [DEPLOYMENT.md](DEPLOYMENT.md#deploy-em-produ√ß√£o)
- **Demonstra√ß√£o**: Qualquer computador ‚Üí [DEPLOYMENT.md](DEPLOYMENT.md#deploy-para-demonstra√ß√£o)
- **Desenvolvimento**: Ambiente local ‚Üí [DEVELOPER.md](DEVELOPER.md)
- **Integra√ß√£o**: API e WebSocket ‚Üí [API.md](API.md)

### üß™ Ambiente Simulado
O PowerEdge detecta automaticamente se est√° rodando em hardware real ou simulado:
- **Hardware detectado**: Modo produ√ß√£o com leituras reais
- **Sem hardware**: Modo simula√ß√£o com dados realistas
- **Mesmo c√≥digo**: Interface e funcionalidades id√™nticas
- **Detalhes**: Ver [ARCHITECTURE.md](ARCHITECTURE.md#separa√ß√£o-de-ambiente)

## üöÄ Quick Start

### Raspberry Pi (Produ√ß√£o)
```bash
git clone <repo-url>
cd PowerEdge
./install.sh
python app/run.py
```

### Qualquer PC (Demonstra√ß√£o)
```bash
git clone <repo-url>
cd PowerEdge
pip install flask flask-socketio
python app/run.py
```

Acesse: **http://localhost:5000**

## ü§ù Contribuindo

1. Fork o projeto
2. Crie uma branch para sua feature
3. Commit suas mudan√ßas
4. Push para a branch
5. Abra um Pull Request

Consulte [DEVELOPER.md](DEVELOPER.md) para padr√µes de c√≥digo e arquitetura.

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo `LICENSE` para mais detalhes.

## üë• Suporte

- **üêõ Bugs**: Use o GitHub Issues
- **‚ùì D√∫vidas**: Consulte [FAQ.md](FAQ.md) primeiro
- **üí° Sugest√µes**: GitHub Discussions
- **üîß Problemas**: Ver [FAQ.md](FAQ.md#troubleshooting)

### Suporte por Categoria
- **Instala√ß√£o**: [INSTALLATION.md](INSTALLATION.md)
- **Hardware**: [FAQ.md](FAQ.md#problemas-de-hardware)
- **API**: [API.md](API.md)
- **Deploy**: [DEPLOYMENT.md](DEPLOYMENT.md)

---

**PowerEdge v2.0** - Sistema Profissional de Monitoramento de Energia  
Desenvolvido com ‚ù§Ô∏è para Raspberry Pi e demonstra√ß√µes

üìö **Documenta√ß√£o completa dispon√≠vel** | üß™ **Modo simula√ß√£o inclu√≠do** | üîå **API REST + WebSocket**
